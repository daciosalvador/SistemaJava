package dao;

import java.sql.Connection;

import java.sql.Date;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.List;

import dto.ClientesDTO;
import dto.ContaDTO;
import dto.EnderecoDTO;
import javaConnection.ConnectionBdo;

public class ClientesFDAO {
	Connection con = null;
	PreparedStatement pstm = null;
	
	


	public void inserir(ClientesDTO clientesDTO)  {
		try {
			int chaveEnd = insereEndereco(clientesDTO.getEnderecoDTO());

			con = ConnectionBdo.creatConnectionToOracle();
			String sql = "INSERT INTO clientesf(nome_cliente_f, cpf, celular , data_cad_f, COD_ENDERECO) " +
					"VALUES(?, ?, ?, ?, ?)";
			
			pstm = con.prepareStatement(sql);
			pstm.setString(1, clientesDTO.getNome_cliente_F());
			pstm.setString(2, clientesDTO.getCpf());
			pstm.setString(3, clientesDTO.getCelular());
			pstm.setDate(4, new Date(clientesDTO.getData_cad_F().getTime()));
			pstm.setInt(5, chaveEnd);
			
			pstm.execute();
			con.close();
		} catch (Exception e) {			
			
		}
	}
		
	private int insereEndereco(EnderecoDTO enderecoDTO){
		int chave = 0;
		try {
			
			con = ConnectionBdo.creatConnectionToOracle();
			String sql = "INSERT INTO TB_Endereco(LOGADOURO, BAIRRO) " +
					"VALUES(?, ?, ?, ?, ?, ?)";
			pstm = con.prepareStatement(sql);
			pstm.setString(1, enderecoDTO.getLogadouro());
			pstm.setString(2, enderecoDTO.getBairro());
			pstm.setString(3, enderecoDTO.getCidade());
			
			pstm.execute();
			ResultSet result = statement.getGeneratedKeys();
			if(result.next()){
			
				chave = result.getInt(1);
			}
			connection.close();
		} catch (Exception e) {
			
		}
		return chave;
		
	}
		